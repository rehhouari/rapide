try{self["workbox:window:6.1.5"]&&_()}catch(b){}function e(e,t){return new Promise((function(r){var n=new MessageChannel;n.port1.onmessage=function(e){r(e.data)},e.postMessage(t,[n.port2])}))}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}try{self["workbox:core:6.1.5"]&&_()}catch(b){}var r=function(){var e=this;this.promise=new Promise((function(t,r){e.resolve=t,e.reject=r}))};function n(e,t){var r=location.href;return new URL(e,r).href===new URL(t,r).href}var i=function(e,t){this.type=e,Object.assign(this,t)};function s(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function o(){}var a={type:"SKIP_WAITING"};function c(e,t){if(!t)return e&&e.then?e.then(o):Promise.resolve()}var u=function(t){var o,u;function f(e,o){var a,c;return void 0===o&&(o={}),(a=t.call(this)||this).nn={},a.tn=0,a.rn=new r,a.en=new r,a.on=new r,a.un=0,a.an=new Set,a.cn=function(){var e=a.fn,t=e.installing;a.tn>0||!n(t.scriptURL,a.sn)||performance.now()>a.un+6e4?(a.vn=t,e.removeEventListener("updatefound",a.cn)):(a.hn=t,a.an.add(t),a.rn.resolve(t)),++a.tn,t.addEventListener("statechange",a.ln)},a.ln=function(e){var t=a.fn,r=e.target,n=r.state,s=r===a.vn,o={sw:r,isExternal:s,originalEvent:e};!s&&a.mn&&(o.isUpdate=!0),a.dispatchEvent(new i(n,o)),"installed"===n?a.wn=self.setTimeout((function(){"installed"===n&&t.waiting===r&&a.dispatchEvent(new i("waiting",o))}),200):"activating"===n&&(clearTimeout(a.wn),s||a.en.resolve(r))},a.dn=function(e){var t=a.hn,r=t!==navigator.serviceWorker.controller;a.dispatchEvent(new i("controlling",{isExternal:r,originalEvent:e,sw:t,isUpdate:a.mn})),r||a.on.resolve(t)},a.gn=(c=function(e){var t=e.data,r=e.source;return s(a.getSW(),(function(){a.an.has(r)&&a.dispatchEvent(new i("message",{data:t,sw:r,originalEvent:e}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(c.apply(this,e))}catch(r){return Promise.reject(r)}}),a.sn=e,a.nn=o,navigator.serviceWorker.addEventListener("message",a.gn),a}u=t,(o=f).prototype=Object.create(u.prototype),o.prototype.constructor=o,o.__proto__=u;var h,l=f.prototype;return l.register=function(e){var t,r,o=(void 0===e?{}:e).immediate,a=void 0!==o&&o;try{var u=this;return t=function(){return u.mn=Boolean(navigator.serviceWorker.controller),u.yn=u.pn(),s(u.bn(),(function(e){u.fn=e,u.yn&&(u.hn=u.yn,u.en.resolve(u.yn),u.on.resolve(u.yn),u.yn.addEventListener("statechange",u.ln,{once:!0}));var t=u.fn.waiting;return t&&n(t.scriptURL,u.sn)&&(u.hn=t,Promise.resolve().then((function(){u.dispatchEvent(new i("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),u.hn&&(u.rn.resolve(u.hn),u.an.add(u.hn)),u.fn.addEventListener("updatefound",u.cn),navigator.serviceWorker.addEventListener("controllerchange",u.dn,{once:!0}),u.fn}))},(r=function(){if(!a&&"complete"!==document.readyState)return c(new Promise((function(e){return window.addEventListener("load",e)})))}())&&r.then?r.then(t):t()}catch(f){return Promise.reject(f)}},l.update=function(){try{return this.fn?c(this.fn.update()):void 0}catch(b){return Promise.reject(b)}},l.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},l.messageSW=function(t){try{return s(this.getSW(),(function(r){return e(r,t)}))}catch(b){return Promise.reject(b)}},l.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&e(this.fn.waiting,a)},l.pn=function(){var e=navigator.serviceWorker.controller;return e&&n(e.scriptURL,this.sn)?e:void 0},l.bn=function(){try{var e=this;return function(t,r){try{var n=s(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}catch(i){return r(i)}return n&&n.then?n.then(void 0,r):n}(0,(function(e){throw e}))}catch(t){return Promise.reject(t)}},(h=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(f.prototype,h),f}(function(){function e(){this.Pn=new Map}var r=e.prototype;return r.addEventListener=function(e,t){this.Sn(e).add(t)},r.removeEventListener=function(e,t){this.Sn(e).delete(t)},r.dispatchEvent=function(e){e.target=this;for(var r,n=function(e,r){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(this.Sn(e.type));!(r=n()).done;)(0,r.value)(e)},r.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var l,d=((l={exports:{}}).exports=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function t(e){var t,r=e.replace(/^v/,"").replace(/\+.*$/,""),n=-1===(t=r).indexOf("-")?t.length:t.indexOf("-"),i=r.substring(0,n).split(".");return i.push(r.substring(n+1)),i}function r(e){return isNaN(Number(e))?e:Number(e)}function n(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function i(e,i){[e,i].forEach(n);for(var s=t(e),o=t(i),a=0;a<Math.max(s.length-1,o.length-1);a++){var c=parseInt(s[a]||0,10),u=parseInt(o[a]||0,10);if(c>u)return 1;if(u>c)return-1}var f=s[s.length-1],h=o[o.length-1];if(f&&h){var l=f.split(".").map(r),d=h.split(".").map(r);for(a=0;a<Math.max(l.length,d.length);a++){if(void 0===l[a]||"string"==typeof d[a]&&"number"==typeof l[a])return-1;if(void 0===d[a]||"string"==typeof l[a]&&"number"==typeof d[a])return 1;if(l[a]>d[a])return 1;if(d[a]>l[a])return-1}}else if(f||h)return f?-1:1;return 0}var s=[">",">=","=","<","<="],o={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return i.validate=function(t){return"string"==typeof t&&e.test(t)},i.compare=function(e,t,r){!function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===s.indexOf(e))throw new TypeError("Invalid operator, expected one of "+s.join("|"))}(r);var n=i(e,t);return o[r].indexOf(n)>-1},i}(),l.exports),p=function(e){return null==e},v=function(e){return Object.getPrototypeOf(e)===Object.prototype},g=function(e){return Array.isArray(e)},w=function(e,t){return Object.entries(e).forEach((function(r){var n=r[0],i=r[1];p(i)||!v(i)&&!g(i)||(e[n]=w(i,t))})),new Proxy(e,{get:function(e,r,n){return t.get(e,r,n)},set:function(e,r,n,i){p(n)||!v(n)&&!g(n)||(n=w(n,t));var s=e[r];return e[r]=n,p(s)||p(s.__watchers)||(e[r].__watchers=s.__watchers),t.set(e,r,e[r],i),!0}})},y={stores:{},persistenceDriver:window.localStorage,persisted:[],subscribers:[],pendingWatchers:{},disableReactivity:!1,startingCallbacks:[],startedCallbacks:[],hasStarted:!1,start:function(){var e=this;this.startingCallbacks.forEach((function(e){return e()})),this.attach(),this.stores=w(this.stores,{get:function(t,r,n){return Object.is(n,e.stores)&&["get","set","toggle","call","clear"].includes(r)?e[r].bind(e):Reflect.get(t,r,n)},set:function(t,r,n,i){if(!e.disableReactivity){e.updateSubscribers(),e.runWatchers(t,r,n,i),e.disableReactivity=!0;try{e.persisted.forEach(e.updateLocalStorage.bind(e))}catch(s){}e.disableReactivity=!1}}}),this.hasStarted=!0,this.disableReactivity=!0,Object.entries(this.pendingWatchers).forEach((function(t){var r=t[0];t[1].forEach((function(t){return e.watch(r,t)}))})),this.disableReactivity=!1,this.startedCallbacks.forEach((function(e){return e()}))},starting:function(e){this.startingCallbacks.push(e)},started:function(e){this.startedCallbacks.push(e)},attach:function(){if(!(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")||window.Alpine&&d.compare(window.Alpine.version,"2.7.0",">=")))throw new Error("[Spruce] You must be using Alpine >= 2.5.0 to use Spruce.");var e=this;window.Alpine.addMagicProperty("store",(function(t){return e.subscribe(t),e.stores}))},store:function(e,t,r){if(void 0===r&&(r=!1),"function"==typeof t&&(t=t()),r)try{this.stores[e]=this.retrieveFromLocalStorage(e,(n={},Object.entries(t).filter((function(e){return"function"==typeof e[1]})).forEach((function(e){return n[e[0]]=e[1]})),n)),this.persisted.includes(e)||this.persisted.push(e)}catch(i){}var n;return this.stores[e]||(this.stores[e]=t),this.stores[e]},reset:function(e,t){void 0!==this.stores[e]&&(this.stores[e]=t)},subscribe:function(e){return this.subscribers.includes(e)||this.subscribers.push(e),this.stores},updateSubscribers:function(){this.subscribers.filter((function(e){return!!e.__x})).forEach((function(e){e.__x.updateElements(e)}))},retrieveFromLocalStorage:function(e,t){void 0===t&&(t={});var r=this.persistenceDriver.getItem("__spruce:"+e);if(!r)return null;var n=JSON.parse(r);return"object"==typeof n&&(delete(n=Object.assign(t,n)).__watchers,delete n.__key_name),n},updateLocalStorage:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.store(e));delete t.__watchers,delete t.__key_name,this.persistenceDriver.setItem("__spruce:"+e,JSON.stringify(this.store(e)))},get:function(e,t){return void 0===t&&(t=this.stores),e.split(".").reduce((function(e,t){return e[t]}),t)},set:function(e,t,r){return void 0===r&&(r=this.stores),g(e)||(e=e.split(".")),1===e.length?r[e[0]]=t:(r[e[0]]||(r[e[0]]={}),this.set(e.slice(1),t,r[e[0]]))},toggle:function(e){return this.set(e,!this.get(e))},call:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return this.get(e).apply(void 0,t)},clear:function(e){return this.persistenceDriver.removeItem("__spruce:"+e)},watch:function(e,t){var r=this;if(!this.hasStarted)return this.pendingWatchers[e]||(this.pendingWatchers[e]=[]),this.pendingWatchers[e].push(t),[function(){return r.unwatch(e,t)}];var n=e.split("."),i=n.reduce((function(e,t){var r=e[t];return p(r)||!v(r)&&!g(r)?e:r}),this.stores),s=Object.is(i,this.get(e))?"__self":n[n.length-1];return i.__watchers||(i.__watchers=new Map),i.__watchers.has(s)||i.__watchers.set(s,new Set),i.__watchers.get(s).add(t),[function(){return r.unwatch(e,t)}]},unwatch:function(e,t){var r=e.split("."),n=r.reduce((function(e,t){var r=e[t];return p(r)||!v(r)&&!g(r)?e:r}),this.stores),i=Object.is(n,this.get(e))?"__self":r[r.length-1],s=n.__watchers;s.has(i)&&s.get(i).delete(t)},watchers:function(e){var t=e.split("."),r=t.reduce((function(e,t){var r=e[t];return p(r)||!v(r)&&!g(r)?e:r}),this.stores),n=Object.is(r,this.get(e))?"__self":t[t.length-1];return r.__watchers?r.__watchers.get(n):{}},runWatchers:function(e,t,r){e.__watchers&&(e.__watchers.has(t)&&e.__watchers.get(t).forEach((function(e){return e(r)})),e.__watchers.has("__self")&&e.__watchers.get("__self").forEach((function(e){return e(r,t)})))},persistUsing:function(e){if(this.persisted.length>0&&console.warn("[Spruce] You have already initialised a persisted store. Changing the driver may cause issues."),"function"!=typeof e.getItem)throw new Error("[Spruce] The persistence driver must have a `getItem(key)` method.");if("function"!=typeof e.setItem)throw new Error("[Spruce] The persistence driver must have a `setItem(key, value)` method.");if("function"!=typeof e.removeItem)throw new Error("[Spruce] The persistence driver must have a `removeItem(name)` method.");this.persistenceDriver=e}};window.Spruce=y;var m=window.deferLoadingAlpine||function(e){e()};window.deferLoadingAlpine=function(e){window.Spruce.start(),m(e)};export{y as c,e as n,u as v};
